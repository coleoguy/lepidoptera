qmat = qmat,
iter = 1200,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree$tree$rates
rate <- c(.25,.5,1,2,4)
get.rates(tree = tree,
edge = 198,
rates = rate,
rate.class = rate.class)
library(ape)
library(viridis)
library(phytools)
source("functions.R")
library(castor)
library(phytools)
library(diversitree)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
nodelabels(cex=.5)
# make a simple model
qmat <- matrix(data = c(-.4,.4,.4,-.4),
nrow = 2,
ncol = 2)
colnames(qmat) <- rownames(qmat) <- c("1","2")
# get tip states
# trait <- sample(c(1,2), tips, replace = T)
trait <- sim.character(tree = tree,
pars = qmat,
model = "mkn",x0 = 2)
trait2 <- rep(1, 100)
trait2[74:100] <- sample(c(1,2), size=27, replace=T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1200,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree$tree$rates
rate <- c(.25,.5,1,2,4)
get.rates(tree = tree,
edge = 198,
rates = rate,
rate.class = rate.class)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
#make tree
tree <- rcoal(n = tips)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
tree <- rcoal(n = tips)
plot(tree,cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
set.seed(1)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
nodelabels(cex=.5)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
set.seed(1)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
nodelabels(cex=.5)
#make tree
set.seed(2)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
#make tree
set.seed(3)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
nodelabels(cex=.5)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
#make tree
set.seed(3)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
tree$tip.label
library(ape)
library(viridis)
library(phytools)
source("functions.R")
library(castor)
library(phytools)
library(diversitree)
rate.class <- 1:5
rates <- c(.25,.5,1,2,4)
tips <- 100
#make tree
set.seed(3)
tree <- rcoal(n = tips)
plot(tree,cex=.5)
nodelabels(cex=.5)
# make a simple model
qmat <- matrix(data = c(-.4,.4,.4,-.4),
nrow = 2,
ncol = 2)
colnames(qmat) <- rownames(qmat) <- c("1","2")
# get tip states
# trait <- sample(c(1,2), tips, replace = T)
trait <- sim.character(tree = tree,
pars = qmat,
model = "mkn",x0 = 2)
trait2 <- rep(1, 100)
trait2[85:100] <- sample(c(1,2), size=16, replace=T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1200,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree$tree$rates
rate <- c(.25,.5,1,2,4)
get.rates(tree = tree,
edge = 198,
rates = rate,
rate.class = rate.class)
get.rates(tree = tree,
edge = 198,
rates = rate,
rate.class = rate.class)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1200,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1200,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1400,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 1400,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
plot(painted.tree$tree, show.tip.label = F)
painted.tree$tree$edge.length
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 4000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
sample_mode = "median",return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
source('C:/Users/prada/Dropbox/leps/analysis/rscripts/treepainter/functions.R')
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait2,
qmat = qmat,
iter = 5000,
rate.class = rate.class,
rates = rates,
return_br_table = T)
plot(tree,
show.tip.label = F,
edge.color = viridis(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
plot(tree,
show.tip.label = F,
edge.color = rainbow(5)[as.factor(painted.tree$tree$rates)],
edge.width = 2)
library(ape)
library(viridis)
library(phytools)
source("functions.R")
library(castor)
library(phytools)
library(diversitree)
rate.class <- 1:7
rates <- c(.7,.8,.9,1,1.1,1.2,1.3)
tips <- 100
#make tree
# set.seed(3)
tree <- rcoal(n = tips)
# make a simple model
qmat <- matrix(data = c(-.4,.4,.4,-.4),
nrow = 2,
ncol = 2)
colnames(qmat) <- rownames(qmat) <- c("1","2")
# get tip states
# trait <- sample(c(1,2), tips, replace = T)
trait <- sim.character(tree = tree,
pars = qmat,
model = "mkn",x0 = 2)
trait2 <- rep(1, 100)
trait2[85:100] <- sample(c(1,2), size=16, replace=T)
painted.tree <- treePaintR(tree = tree,
tip_states = trait,
qmat = qmat,
iter = 10000,
rate.class = rate.class,
rates = rates)
cols <- heat.colors(7)[7:1]
par(bg="gray")
plot(tree,
show.tip.label = F,
edge.color = cols[as.factor(painted.tree$tree$rates)],
edge.width = 2)
plot(painted.tree$lk.trace, type = "l",
ylab = "-loglikelihood",
xlab = "Iteration")
